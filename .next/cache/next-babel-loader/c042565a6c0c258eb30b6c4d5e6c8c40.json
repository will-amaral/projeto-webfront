{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Router from 'next/router';\nimport cookie from 'js-cookie';\nimport nextCookie from 'next-cookies';\nimport { setHeader } from './api';\nexport function login(token) {\n  cookie.set('token', token, {\n    expires: 1\n  });\n  Router.push('/');\n}\nexport function logout() {\n  cookie.remove('token');\n  Router.push('/login');\n}\nexport function auth(ctx) {\n  const {\n    token\n  } = nextCookie(ctx);\n\n  if (ctx.req && !token) {\n    console.log('Não existem cookies');\n    ctx.res.writeHead(302, {\n      Location: '/login'\n    });\n    ctx.res.end();\n  }\n\n  if (!token) {\n    console.log('Não existe token');\n    Router.push('/login');\n  }\n\n  console.log('Cookie: ' + token);\n  return token;\n}\nexport function withAuth(WrappedComponent) {\n  function Wrapper(props) {\n    return __jsx(WrappedComponent, props);\n  }\n\n  Wrapper.getInitialProps = async function (ctx) {\n    const token = auth(ctx);\n    setHeader(token);\n    const componentProps = WrappedComponent.getInitialProps && (await WrappedComponent.getInitialProps(ctx));\n    return _objectSpread({}, componentProps, {\n      token\n    });\n  };\n\n  return Wrapper;\n}","map":null,"metadata":{},"sourceType":"module"}