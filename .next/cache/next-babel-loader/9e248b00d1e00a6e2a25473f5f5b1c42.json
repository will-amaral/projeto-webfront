{"ast":null,"code":"import Router from 'next/router';\nimport cookie from 'js-cookie';\nimport nextCookie from 'next-cookies';\nexport function login(token) {\n  cookie.set('token', token, {\n    expires: 1\n  });\n  Router.push('/');\n}\nexport function logout() {\n  cookie.remove('token');\n  Router.push('/login');\n}\nexport function auth(ctx) {\n  const {\n    token\n  } = nextCookie(ctx);\n\n  if (ctx.req && !token) {\n    ctx.res.writeHead(302, {\n      Location: '/login'\n    });\n    ctx.res.end();\n  }\n\n  if (!token) {\n    Router.push('/login');\n  }\n\n  return token;\n}","map":{"version":3,"sources":["/home/will/Documents/School/Projeto-IFSP/projeto-webfront/utils/auth.js"],"names":["Router","cookie","nextCookie","login","token","set","expires","push","logout","remove","auth","ctx","req","res","writeHead","Location","end"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,aAAnB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,UAAP,MAAuB,cAAvB;AAEA,OAAO,SAASC,KAAT,CAAeC,KAAf,EAAsB;AACzBH,EAAAA,MAAM,CAACI,GAAP,CAAW,OAAX,EAAoBD,KAApB,EAA2B;AAAEE,IAAAA,OAAO,EAAE;AAAX,GAA3B;AACAN,EAAAA,MAAM,CAACO,IAAP,CAAY,GAAZ;AACH;AAED,OAAO,SAASC,MAAT,GAAkB;AACrBP,EAAAA,MAAM,CAACQ,MAAP,CAAc,OAAd;AACAT,EAAAA,MAAM,CAACO,IAAP,CAAY,QAAZ;AACH;AAED,OAAO,SAASG,IAAT,CAAcC,GAAd,EAAmB;AACtB,QAAM;AAAEP,IAAAA;AAAF,MAAYF,UAAU,CAACS,GAAD,CAA5B;;AAEA,MAAIA,GAAG,CAACC,GAAJ,IAAW,CAACR,KAAhB,EAAuB;AACnBO,IAAAA,GAAG,CAACE,GAAJ,CAAQC,SAAR,CAAkB,GAAlB,EAAuB;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAAvB;AACAJ,IAAAA,GAAG,CAACE,GAAJ,CAAQG,GAAR;AACH;;AAED,MAAI,CAACZ,KAAL,EAAY;AACRJ,IAAAA,MAAM,CAACO,IAAP,CAAY,QAAZ;AACH;;AAED,SAAOH,KAAP;AACH","sourcesContent":["import Router from 'next/router';\nimport cookie from 'js-cookie';\nimport nextCookie from 'next-cookies';\n\nexport function login(token) {\n    cookie.set('token', token, { expires: 1 });\n    Router.push('/')\n}\n\nexport function logout() {\n    cookie.remove('token');\n    Router.push('/login');\n}\n\nexport function auth(ctx) {\n    const { token } = nextCookie(ctx);\n\n    if (ctx.req && !token) {\n        ctx.res.writeHead(302, { Location: '/login' });\n        ctx.res.end()\n    }\n\n    if (!token) {\n        Router.push('/login');\n    }\n\n    return token\n}\n"]},"metadata":{},"sourceType":"module"}